<html>
	<head>
		<script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			  crossorigin="anonymous"></script>
		<script>
		var divId="#previewIconDiv";
		var imgSlideDown=0;
		var returnUrl = '%(content_item_return_url)s';
		var iconUrl1 = "icon1.json";
		var iconUrl2 = "icon2.json";
		var iconUrl3 = "icon3.json";
		var iconUrl4 = "icon4.json";
		var iconUrl5 = "icon5.json";
		var iconUrl6 = "icon6.json";
		var iconUrl7 = "icon7.json";
		var iconUrl8 = "icon8.json";
		var iconUrl9 = "icon9.json";
		var iconUrl10 = "icon10.json";
		var iconUrl11 = "icon11.json";
		var iconUrl12 = "icon12.json";
		var iconUrl13 = "icon13.json";
		var iconUrl14 = "icon14.json";
		var iconUrl15 = "icon15.json";
		var currentIconUrl = "";
		function updateField( event ) {
			//update the field value
			var target = $( event.target );
			console.log( target );
			var tmpFieldValue = target.first().attr('src');
			jQuery( "#content_items" ).val( tmpFieldValue );
			jQuery( "#return_form" ).submit();
		}
		function editIcons(){
        	let editIconsUrl = "iconSelector.pyg?showUpdateIcons=1&iconUrl=" + currentIconUrl;
          	let tmpWin=window.open( editIconsUrl, '_blank' );
        	tmpWin.focus();
        }
		function loadIcons( iconUrl ){
			let returnHtml = "";
			let tmpObj = {};
			
			let iconAr = [];
            let tmpT = new Date().getTime();
          	currentIconUrl = iconUrl;
            iconUrl = iconUrl + "?t="+tmpT;
			$.getJSON( iconUrl , function( udata ) {
				iconAr = udata.icons;
				console.log( udata, iconAr );
				for ( let i=0; i< iconAr.length; i++ ){
					tmpObj = iconAr[i];	
					returnHtml += `
					<div class="icon">
						<img src="${tmpObj.url}"  
						alt="${tmpObj.title}"  
						title="${tmpObj.title}" 
						width="${tmpObj.width}" 
						height="${tmpObj.height}" />
					</div>`;
				}
				if ( returnHtml!="" ) {
					jQuery('#container').html( returnHtml );
				}
				jQuery('#container').ready( function(){
						jQuery('.icon').on( "click", updateField );
					}
				);
			}) 
  			.fail(function( jqxhr, textStatus, error ) {
				var err = textStatus + ", " + error;
				console.log( "Request Failed: " + err );
			});
			
		}

		loadIcons( "icon15.json" );
		
		jQuery('document').ready( function(){
				jQuery('.icon').on( "click", updateField );
			}
		);
		</script>
<style>
.icon {
display:inline;
float:left;
padding: 10px;
font-size:x-small;
text-align: center;
cursor: pointer;
}
input, select{
    background: #f5f5f5;
    color: #2D3B45;
    border: 1px solid;
    border-color: #C7CDD1;
    border-radius: 3px;
    transition: background-color 0.2s ease-in-out;
    position: relative;
    padding: 8px 14px;
    margin-bottom: 0;
    font-size: 1rem;
    line-height: 20px;
    text-align: center;
    vertical-align: middle;
}
input:hover {
    background: #e8e8e8;
    color: #2D3B45;
}
</style>
	</head>
	<body>
		<select onchange="loadIcons(eval(this.options[this.selectedIndex].value))" />
          <option value="iconUrl15">Teaching</option>
          <option value="iconUrl1">General</option>
          <option value="iconUrl2">Aotearoa</option>
          <option value="iconUrl3">Architecture</option>
          <option value="iconUrl4">Arts</option>
          <option value="iconUrl5">Business</option>
          <option value="iconUrl6">Engineering</option>
          <option value="iconUrl7">Food</option>
          <option value="iconUrl8">Law</option>
          <option value="iconUrl9">Medical</option>
          <option value="iconUrl10">People</option>
          <option value="iconUrl11">Places</option>
          <option value="iconUrl12">Science</option>
          <option value="iconUrl13">Sports</option>
          <option value="iconUrl14">Time</option>
        </select><br />
<!--
		<input id="iconset1" type="button" onclick="loadIcons( iconUrl1 );return false;" value="General" /> 
		<input  id="iconset2" type="button" onclick="loadIcons( iconUrl2 );return false;" value="Aotearoa" />
        <input  id="iconset3" type="button" onclick="loadIcons( iconUrl3 );return false;" value="Architecture" />
        <input  id="iconset4" type="button" onclick="loadIcons( iconUrl4 );return false;" value="Arts" />
-->
		<br>
		<div class="container" id="container">
		</div>

		<form action="iconSelector.pyg" id="return_form" method="post" class="hide" encType="application/x-www-form-urlencoded">
			<input type="hidden" name="returnCanvas" />
			<input type="hidden" name="returnUrl" value="%(content_item_return_url)s" />
			<input type="hidden" id="content_items" name="content_items" value="" />
			<input type="hidden" name="data" value="%(data)s">
		</form>
	</body>
</html>
